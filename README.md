# Error Monitor Bot - –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤

## –û–ø–∏—Å–∞–Ω–∏–µ
Error Monitor Bot - —ç—Ç–æ —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏—Ö —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∏ –æ—à–∏–±–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑:
- API —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –ø—Ä–∏–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
- Telegram –±–æ—Ç–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- SDK –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–æ–≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤ (heartbeat)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ Telegram
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–æ–µ–∫—Ç–æ–≤ (–±–æ—Ç—ã, –≤–µ–±-—Å–∞–π—Ç—ã –∏ –¥—Ä.)
- –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥–ø–∏—Å–æ–∫ –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
# –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone [url_—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è]
cd error_monitor_bot

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
python init_db.py
python run_migrate.py
```

### 2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ API —Å–µ—Ä–≤–µ—Ä
python run_api.py

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
python run_bot.py
```

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

#### –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç add_project.py
```bash
python add_project.py --name "–ú–æ–π –ø—Ä–æ–µ–∫—Ç" --type "bot" --url "https://example.com"
```

#### –ò–ª–∏ —á–µ—Ä–µ–∑ SQL
```sql
INSERT INTO projects (name, type, token, url, is_active) 
VALUES ('–ú–æ–π –ø—Ä–æ–µ–∫—Ç', 'bot', '–≤–∞—à-—É–Ω–∏–∫–∞–ª—å–Ω—ã–π-—Ç–æ–∫–µ–Ω', 'https://example.com', 1);
```

### 4. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ø—Ä–æ–µ–∫—Ç—É

#### Python SDK
```python
from error_monitor_bot.sdk.python import ErrorMonitor

monitor = ErrorMonitor(
    project_token="–≤–∞—à-—Ç–æ–∫–µ–Ω-–ø—Ä–æ–µ–∫—Ç–∞",
    api_url="http://localhost:8000/api/v1"
)

# –û—Ç–ø—Ä–∞–≤–∫–∞ heartbeat
await monitor.send_heartbeat(
    version="1.0.0",
    additional_data={"env": "production"}
)

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
try:
    # –≤–∞—à –∫–æ–¥
    raise Exception("–¢–µ—Å—Ç–æ–≤–∞—è –æ—à–∏–±–∫–∞")
except Exception as e:
    await monitor.send_error(e, context={"important": "data"})
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:

```sql
-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞
INSERT INTO subscribers (telegram_id, full_name, is_admin, subscribed_projects) 
VALUES (–≤–∞—à_telegram_id, '–í–∞—à–µ –∏–º—è', 1, '[1,2,3]');
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

–°–∏—Å—Ç–µ–º–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª—É—á–∞—è—Ö:
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ heartbeat –æ—Ç –ø—Ä–æ–µ–∫—Ç–∞ (—Å—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏)
- –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–ª heartbeat –±–æ–ª–µ–µ —á–∞—Å–∞
- –ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–æ–∫ –≤ –ø—Ä–æ–µ–∫—Ç–µ

### 3. –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –ø—Ä–æ–≤–µ—Ä–∫–∏
- Heartbeat: —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–∞–∂–¥—ã–µ 5-15 –º–∏–Ω—É—Ç
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤: –∫–∞–∂–¥—ã–π —á–∞—Å
- –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—à–∏–±–æ–∫: –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏

## API Endpoints

### Heartbeat
```http
POST /api/v1/heartbeat
Content-Type: application/json

{
    "project_token": "–≤–∞—à-—Ç–æ–∫–µ–Ω-–ø—Ä–æ–µ–∫—Ç–∞",
    "status": "alive",
    "version": "1.0.0",
    "metadata": {
        "environment": "production",
        "custom_field": "value"
    }
}
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
```http
POST /api/v1/log
Content-Type: application/json

{
    "project_token": "–≤–∞—à-—Ç–æ–∫–µ–Ω-–ø—Ä–æ–µ–∫—Ç–∞",
    "error": {
        "type": "Exception",
        "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏",
        "stack_trace": "...",
        "severity": "error",
        "context": {
            "user_id": 123,
            "action": "checkout"
        }
    }
}
```

## –ö–æ–º–∞–Ω–¥—ã Telegram –±–æ—Ç–∞

- `/start` - –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã —Å –±–æ—Ç–æ–º
- `/addproject` - –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
- `/listprojects` - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- `/subscribe` - –ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- `/unsubscribe` - –û—Ç–ø–∏—Å–∞—Ç—å—Å—è –æ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `/stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–æ–µ–∫—Ç—É

## –¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### 1. Heartbeat —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
```
‚úÖ –ü—Ä–æ–µ–∫—Ç –∞–∫—Ç–∏–≤–µ–Ω

üìù –ü—Ä–æ–µ–∫—Ç: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
üè∑Ô∏è –¢–∏–ø: bot
üìä –°—Ç–∞—Ç—É—Å: alive
üîÑ –í–µ—Ä—Å–∏—è: 1.0.0
‚è∞ –í—Ä–µ–º—è: 2024-03-06 12:00:00

üìã –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
‚Ä¢ environment: production
‚Ä¢ custom_field: value
```

### 2. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
```
‚ùå –í–Ω–∏–º–∞–Ω–∏–µ! –ü—Ä–æ–µ–∫—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

üìù –ü—Ä–æ–µ–∫—Ç: –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
üè∑Ô∏è –¢–∏–ø: bot
‚ö†Ô∏è –°—Ç–∞—Ç—É—Å: –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –±–æ–ª–µ–µ —á–∞—Å–∞
‚è∞ –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: 2024-03-06 11:00:00
```

### 3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
```
üö® –ù–æ–≤–∞—è –æ—à–∏–±–∫–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ

–¢–∏–ø: Exception
–°–æ–æ–±—â–µ–Ω–∏–µ: –û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏
–í–∞–∂–Ω–æ—Å—Ç—å: error
–í—Ä–µ–º—è: 2024-03-06 12:00:00
```

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ heartbeat**
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ—Ç–ø—Ä–∞–≤–∫–∏ (5-15 –º–∏–Ω—É—Ç)
   - –î–æ–±–∞–≤–ª—è–π—Ç–µ –ø–æ–ª–µ–∑–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ metadata

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ try-except –±–ª–æ–∫–∏ –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö
   - –î–æ–±–∞–≤–ª—è–π—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫ –æ—à–∏–±–∫–∞–º
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –≤–∞–∂–Ω–æ—Å—Ç–∏

3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
   - –•—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å–ø–∏—Å–æ–∫ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤

4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–∞–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
   - –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ç—Ä–µ–Ω–¥—ã –æ—à–∏–±–æ–∫

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ API —Å–µ—Ä–≤–µ—Ä–∞ –∏ –±–æ—Ç–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É —Å–∏—Å—Ç–µ–º—ã 